import pandas as pd

# Read both Excel files
excel_a = pd.read_excel('ExcelA.xlsx')
excel_b = pd.read_excel('ExcelB.xlsx')

# Create a new URL column in ExcelA if it doesn't exist
if 'URL' not in excel_a.columns:
    excel_a['URL'] = ''

# Function to check if user exists in comma-separated string
def find_user_url(user, df_b):
    for index, row in df_b.iterrows():
        # Split comma-separated users and strip whitespace
        users_list = [u.strip() for u in row['Users'].split(',')]
        if user in users_list:
            return row['URL']
    return ''

# Iterate through each user in ExcelA
for index, row in excel_a.iterrows():
    user = row['Users']
    # Find matching URL from ExcelB
    url = find_user_url(user, excel_b)
    # Update URL column in ExcelA
    excel_a.at[index, 'URL'] = url

# Save the modified ExcelA
excel_a.to_excel('ExcelA_modified.xlsx', index=False)

print("Processing complete. Output saved to ExcelA_modified.xlsx")